
            const isOpen = (day !== 2 && currentTime >= 18.5 && currentTime <= 24);
            document.getElementById('status-dot').className = isOpen ? 'dot open' : 'dot closed';
            document.getElementById('status-text').innerText = isOpen ? 'ABERTO AGORA' : 'FECHADO AGORA';
        }

        function openSizeModal(id) {
            closeModals();
            const p = productsData[id];
            if(p.p === 0) { addToCart(id, 'Unico', p.g); return; }
            document.getElementById('size-options').innerHTML = `
                <div class="size-option" onclick="addToCart('${id}', 'Pequena', ${p.p})"><span>Pequena (P)</span><b>R$ ${p.p.toFixed(2)}</b></div>
                <div class="size-option" onclick="addToCart('${id}', 'Grande', ${p.g})"><span>Grande (G)</span><b>R$ ${p.g.toFixed(2)}</b></div>`;
            document.getElementById('sizeModal').style.display = 'flex';
        }

        function openHalfModal() {
            closeModals();
            const list = document.getElementById('half-list'); list.innerHTML = ''; selectedHalf = [];
            for (let id in productsData) {
                if(productsData[id].cat === 'salgada' && productsData[id].p !== 0) {
                    list.innerHTML += `
                    <div class="half-select-item" id="h-${id}" onclick="toggleHalf('${id}')">
                        <div class="half-select-info">
                            <span style="font-weight: 700; font-size: 0.9rem;">${productsData[id].name}</span>
                            <span class="half-select-desc">${productsData[id].desc}</span>
                        </div>
                        <b style="color: var(--accent-color);">R$ ${productsData[id].g.toFixed(2)}</b>
                    </div>`;
                }
            }
            document.getElementById('halfModal').style.display = 'flex';
            const btn = document.getElementById('confirmHalfBtn');
            btn.disabled = true; btn.style.opacity = 0.5;
        }

        function toggleHalf(id) {
            const el = document.getElementById(`h-${id}`);
            const idx = selectedHalf.indexOf(id);
            if(idx > -1) { selectedHalf.splice(idx,1); el.classList.remove('selected'); }
            else if(selectedHalf.length < 2) { selectedHalf.push(id); el.classList.add('selected'); }
            const btn = document.getElementById('confirmHalfBtn');
            btn.disabled = selectedHalf.length !== 2; btn.style.opacity = btn.disabled ? 0.5 : 1;
        }

        function addHalfPizza() {
            if(selectedHalf.length === 2) {
                const p1 = productsData[selectedHalf[0]], p2 = productsData[selectedHalf[1]];
                cart.push({ name: `Meio ${p1.name} / Meio ${p2.name}`, size: 'G', price: Math.max(p1.g, p2.g) });
                updateCart(); closeModals(); showToast("Pizza meio a meio adicionada!");
            }
        }

        function addToCart(id, size, price) {
            cart.push({ name: productsData[id].name, size: size, price: price });
            updateCart(); closeModals(); showToast("Adicionado com sucesso!");
        }

        function addToCartExtra(name, price) {
            cart.push({ name: name, size: 'Un', price: price });
            updateCart(); showToast(`${name} adicionado!`);
        }

        function updateCart() {
            let total = 0; cart.forEach(i => total += i.price);
            document.getElementById('cartBar').classList.toggle('visible', cart.length > 0);
            document.getElementById('cart-count').innerText = `${cart.length} ${cart.length === 1 ? 'ITEM' : 'ITENS'}`;
            document.getElementById('cart-total').innerText = `R$ ${total.toFixed(2).replace('.',',')}`;
            document.getElementById('final-total').innerText = `R$ ${total.toFixed(2).replace('.',',')}`;
        }

        function openCheckout() {
            closeModals();
            const list = document.getElementById('review-list'); list.innerHTML = '';
            cart.forEach((it, idx) => {
                list.innerHTML += `<div class="review-item" style="border-bottom:1px solid rgba(255,255,255,0.05); padding:15px 0;"><div><p style="font-weight:700; font-size:0.95rem;">${it.name}</p><p style="font-size:0.75rem; color:#666;">Tamanho: ${it.size}</p></div><div style="display:flex; align-items:center; gap:15px;"><span style="color:var(--accent-color); font-weight:800;">R$ ${it.price.toFixed(2)}</span><i class="fas fa-trash-can" onclick="removeItem(${idx})" style="color:#ff4757; cursor:pointer; font-size:1.1rem;"></i></div></div>`;
            });
            document.getElementById('checkoutModal').style.display = 'flex';
        }

        function removeItem(idx) { cart.splice(idx,1); updateCart(); if(cart.length===0) closeModals(); else openCheckout(); }

        function sendWhatsApp() {
            const name = document.getElementById('cust-name').value;
            const address = document.getElementById('cust-addr').value;
            const borda = document.getElementById('cust-borda').value;
            if(!name || !address) return showAlert("Por favor, preencha nome e endereÃ§o para entrega!");

            let total = 0;
            let itemsText = "";
            cart.forEach(item => {
                itemsText += `â€¢ *${item.name}* (${item.size}) - R$ ${item.price.toFixed(2)}\n`;
                total += item.price;
            });

            const message = `*NOVO PEDIDO - DOM JAJÃ*\n\nðŸ‘¤ *Cliente:* ${name}\nðŸ“ *EndereÃ§o:* ${address}\nðŸ§€ *Borda:* ${borda}\n\nðŸ›’ *Itens:*\n${itemsText}\nðŸ’° *Total:* R$ ${total.toFixed(2).replace('.',',')}\n\n_Pedido enviado via CardÃ¡pio Digital_`;
            window.open(`https://wa.me/5514997212396?text=${encodeURIComponent(message)}`);
        }

        function showToast(txt) { const t = document.getElementById('toast'); t.innerText = txt; t.classList.add('active'); setTimeout(()=>t.classList.remove('active'), 2500); }
        function closeModals() { 
            document.querySelectorAll('.modal-overlay').forEach(m => m.style.display = 'none');
            selectedHalf = [];
            document.querySelectorAll('.half-select-item').forEach(el => el.classList.remove('selected'));
        }

        window.onload = () => { renderMenu(); updateStatus(); };
    </script>
</body>
</html>
